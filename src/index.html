<!DOCTYPE html>
<html>

<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<script> 
// Initial Setup
  window.document.nextComponentSerial = 0;
  history.pushState({}, 'initial empty state', window.location.pathname);
</script> 
<!-- https://developers.google.com/speed/docs/insights/BlockingJS?hl=ja#InlineJS -->
<script async src="./components/background-album/background-album.js"></script>
<script async src="./components/background-album/background-image/background-image.js"></script>
<script async src="./components/nav-menu/nav-menu.js"></script>
<script async src="./components/nav-menu/menu-piece/menu-piece.js"></script>
<style>
  body {
    display: grid;
    width: 100%;
    height: 100%;
    margin: 0; /* remove default */
    font-family: 游ゴシック体, 'Yu Gothic', YuGothic, 'ヒラギノ角ゴシック Pro', 'Hiragino Kaku Gothic Pro', メイリオ, Meiryo, Osaka, 'ＭＳ Ｐゴシック', 'MS PGothic', sans-serif;
    background: #fdfaf9;
    }
    .\/{
      grid-template-columns: 1fr 1fr 6fr;
    }
    .\/blog{
      grid-template-columns: repeat(3, 1fr 2fr);
    }
    .\/about{
      grid-template-columns: repeat(3, 3fr 2fr);
    }
    a {
      font-weight: 500;
      text-decoration: none;
    }
    .wc-wrapper {
      /* display:  grid; */
    }
  footer {
    position: fixed;
    bottom: 0;
    padding: 6px 18px;
    width: 100%;
    background: linear-gradient(0deg, #fdc, #fcb 8%, #fba 50%, #fcb 80%, #fdc);
    opacity: 0.6;
    font-size: 18px;
  }
  .footer-content {
    text-decoration: none;
  }
  @media screen and (min-width: 769px) {
    footer {
      width: 97%;
      text-align: left;
      background: none;
    }
    .footer-content {
      background: radial-gradient(rgba(255,221,210,1.0), rgba(255,220,210,0));
      border-radius: 12px;
      box-shadow: 0 1px 1px rgba(0,0,0,0.2)
    }
  }
</style>
</head>

<body class>
  <!-- templates for webcomponents -->
  <templates>
  
  <nav-menu src="./store/nav-menu.json">
    <!-- slotでアイコンをつけられるようにする予定 -->
  </nav-menu>
    <!-- <background-album src="./store/background-album.json" interval=6></background-album> -->

  <div id="main" class="wc-wrapper">
  </div>

  <div id="sub" class="wc-wrapper">
    
  </div>

  ISOLATEDTEXT

  <div id="sub2" class="wc-wrapper">

  </div>


  <footer>
    <span class="footer-content">
      view on <a href="https://github.io/lyonish/webcomponents-example-website">github</a>.
    </span>
  </footer>

  <script>
      window.views = {
      "/": {
        main: 'home-main',
        sub: 'home-sub'
      },
      "/blog": {
        main: 'blog-main',
        sub: 'blog-sub'
      },
      "/about": {
        main: 'about-main',
        sub2: 'about-sub2'
      }
    }
    // window.addEventListener('popstate', e => {
    //     console.log('popstate11111');
    //     console.log(e);
    //   });
    window.updateState = function(route){
      history.pushState(history.state, 'update state', route);
      document.body.className = '';
      document.body.classList.add(route);
      const contents = window.views[window.location.pathname];
  const wrappers = document.getElementsByClassName('wc-wrapper');
  let wrapper;
  let template;
  let instance;
  let i = 0;
  
  while(i < wrappers.length){

    wrapper = wrappers[i];
    template = document.getElementById(contents[wrapper.id]);

    if(contents[wrapper.id]){
      if (wrapper.childElementCount == 0){
        wrapper.appendChild(template.content.cloneNode(true));
      } else {
        wrapper.replaceChild(template.content.cloneNode(true), wrapper.children[0]);
      }
      wrapper.hidden = false;
    } else {
      if(wrapper.children[0]){
        wrapper.hidden = true;
        wrapper.removeChild(wrapper.children[0]);
      }
    }
    i = i + 1;
  }
    }
    window.addEventListener('load', e => {
      updateState(window.location.pathname);
    });
  </script>
</body>
</html>

<!-- https://developers.google.com/web/fundamentals/web-components/best-practices?hl=ja -->